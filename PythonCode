import pandas as pd

# Path to your Excel file with all 18 sheets
input_file = "cpng_full_dump.xlsx"  # Replace with your actual filename
xls = pd.ExcelFile(input_file)

summary_rows = []

for sheet_name in xls.sheet_names:
    df = xls.parse(sheet_name)
    if df.empty:
        continue

    for col in df.columns:
        sample_val = df[col].iloc[0] if not df[col].empty else ""
        summary_rows.append({
            "Table Name": sheet_name,
            "Column Name": col,
            "Sample Value": sample_val
        })

# Convert to DataFrame
summary_df = pd.DataFrame(summary_rows)

# Save the result to a new Excel file
output_file = "cpng_column_sample_summary.xlsx"
summary_df.to_excel(output_file, index=False)

print(f"Summary saved to: {output_file}")

import pandas as pd

# Path to your Excel file
excel_file = 'excel/your_excel_file.xlsx'  # Change this to your actual file

# Output CSV file path
output_csv = 'excel/combined_output.csv'

# Read the Excel file
xls = pd.ExcelFile(excel_file)

# Create a list to collect all DataFrames
combined_data = []

# Loop through each sheet and add a column for sheet name
for sheet_name in xls.sheet_names:
    df = xls.parse(sheet_name)
    df.insert(0, 'SheetName', sheet_name)
    combined_data.append(df)

# Concatenate all sheets into one DataFrame
final_df = pd.concat(combined_data, ignore_index=True)

# Save the combined data to a single CSV file
final_df.to_csv(output_csv, index=False)

print(f"All sheets from '{excel_file}' combined into '{output_csv}'")

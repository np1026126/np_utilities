import pandas as pd

# Path to the Excel file (relative to your project structure)
input_file = "excel/cpng_full_dump.xlsx"  # Your file is inside the 'excel' folder

# Load the workbook
xls = pd.ExcelFile(input_file)

summary_rows = []

# Loop through all sheets and extract first-row data
for sheet_name in xls.sheet_names:
    df = xls.parse(sheet_name)
    if df.empty:
        continue
    for col in df.columns:
        sample_val = df[col].iloc[0] if not df[col].empty else ""
        summary_rows.append({
            "Table Name": sheet_name,
            "Column Name": col,
            "Sample Value": sample_val
        })

# Save to a new Excel file
output_file = "excel/cpng_column_sample_summary.xlsx"
summary_df = pd.DataFrame(summary_rows)
summary_df.to_excel(output_file, index=False)

print(f"Summary file saved at: {output_file}")

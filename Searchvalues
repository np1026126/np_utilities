Thanks for the detailed clarification. Based on everything you said, here is the precise and updated prompt you can give to Copilot:


---

✅ Final Copilot Prompt:

> I have two Excel/CSV files:

First sheet: “Rooms in Site List from IFP”
Columns: SITE_ID, SITE_NAME, CLLI, ROOM_NAME, and Location format accepted in Holistic Template.

Second sheet: “Production Migration 1PSC Production VZW Site Sheet”
Columns are the same, but it includes two additional columns:

Add_Delete_Update → shows Add, Update, or Unchanged.

New Site Name → the new room name (if updated).



✅ I want to compare both sheets by CLLI and ROOM_NAME, and update the first sheet in the following way:

1. Add three new columns to the first sheet:

New Room Name

CLLI > Room Name → combine CLLI and ROOM_NAME with > as separator

Status → values should be:

Add → If it's a new room in second sheet (not present in first)

Update → If the room name has changed for same CLLI

Unchanged → If room name and CLLI are same in both sheets




2. If a new room is present in the second sheet (with Add in Add_Delete_Update), insert a new row into the first sheet with:

Existing SITE_ID, SITE_NAME, CLLI

Leave ROOM_NAME and Location format accepted in Holistic Template empty

Fill New Room Name from second sheet

Mark Status as Add



3. If Update is present in the second sheet, find the matching CLLI and ROOM_NAME from the first sheet, and:

Add the updated name in New Room Name

Mark Status as Update



4. Leave other rows untouched, and export the modified result as a new downloadable Excel/CSV file using the format of the first sheet.






---

This prompt tells Copilot exactly what to compare, how to enrich the first sheet, and when to insert new rows. Let me know if you'd also like a working Python script or Excel formula/VBA to do the same.



Here are the shortest / cleanest ways to update one column for many rows in PostgreSQL when you have an Excel file that contains ID + the new value (and maybe a few other columns), but not all DB columns.
Option 1 (Fastest, simplest): Excel → CSV → COPY into a staging table → UPDATE ... FROM
This is the standard “bulk update” approach.
Step A — Save Excel as CSV
In Excel: File → Save As → CSV (UTF-8)
Make sure your CSV has headers like:
id
new_value  (the column you want to update)
Example CSV:
Csv
Copy code
id,new_value
101,ACTIVE
102,INACTIVE
Step B — Create a staging table (only the columns you have)
Sql
Copy code
CREATE TEMP TABLE stg_update (
  id bigint,
  new_value text
);
(Use correct types: uuid, int, numeric, etc.)
Step C — Load CSV into staging table
If you’re using psql (command line):
Sql
Copy code
\copy stg_update(id, new_value)
FROM '/path/updates.csv'
WITH (FORMAT csv, HEADER true);
Step D — Update your real table using join on ID
Sql
Copy code
UPDATE main_table t
SET target_column = s.new_value
FROM stg_update s
WHERE t.id = s.id;
✅ This updates only target_column for matched IDs.
✅ You don’t need other columns at all.
✅ Very fast for large data.
Option 2 (No temp table): Excel → CSV → INSERT ... ON CONFLICT DO UPDATE (Upsert)
Use this if your table’s id is a PRIMARY KEY/UNIQUE and the CSV has exactly the columns you want to insert/update.
Sql
Copy code
CREATE TEMP TABLE stg_update (id bigint, new_value text);

\copy stg_update(id, new_value) FROM '/path/updates.csv' WITH (FORMAT csv, HEADER true);

INSERT INTO main_table (id, target_column)
SELECT id, new_value
FROM stg_update
ON CONFLICT (id)
DO UPDATE SET target_column = EXCLUDED.target_column;
✅ Useful if some IDs might not exist yet (depends on your need).
Option 3 (GUI easiest): DBeaver / pgAdmin import into staging table, then run UPDATE
If you don’t want CLI:
In DBeaver/pgAdmin: Create staging table with only id + new_value
Right click staging table → Import Data → select CSV/Excel
Run:
Sql
Copy code
UPDATE main_table t
SET target_column = s.new_value
FROM stg_update s
WHERE t.id = s.id;
Option 4 (Python short script): pandas + execute_values + UPDATE FROM (VALUES...)
This is handy if you already use Python in your workflow.
Python
Copy code
import pandas as pd
import psycopg2
from psycopg2.extras import execute_values

df = pd.read_excel("updates.xlsx")   # columns: id, new_value

conn = psycopg2.connect(
    host="HOST", dbname="DB", user="USER", password="PWD", port=5432
)
cur = conn.cursor()

rows = list(df[["id", "new_value"]].itertuples(index=False, name=None))

sql = """
UPDATE main_table AS t
SET target_column = v.new_value
FROM (VALUES %s) AS v(id, new_value)
WHERE t.id = v.id
"""
execute_values(cur, sql, rows)

conn.commit()
cur.close()
conn.close()
✅ No staging table, but for very large files, COPY is usually faster.
What I recommend (shortest + safest)
If you want the most reliable and fastest way:
✅ Option 1: CSV + staging + UPDATE FROM
If you tell me these 3 things, I can paste the exact SQL with correct datatypes:
Your table name
The ID column type (int, bigint, uuid?)
The column you want to update + its datatype (text, numeric, timestamp, etc.)

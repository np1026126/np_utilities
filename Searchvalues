Here's the exact Copilot prompt you can use to compare two sheets (original and modified), and add a new column to the modified sheet with the original RPP name only if it has changed:


---

âœ… Copilot Prompt:

> Compare the RPP names between two sheets:

The first sheet is: "floor_pdu_alt.csv" (original from ISP DB).

The second sheet is: "floor_pdu_with_missing.csv" (corrected with new PDUs and updated RPP names).


For each row in the second sheet, if the RPP name in the "Name" column is different from the RPP name for the same site and PDU in the original sheet:

Add a new column "Old RPP Name" to the second sheet.

Populate it with the original RPP name from the first sheet for the corresponding row.

If there is no change in RPP name, leave "Old RPP Name" blank.


Match rows based on:

Site

Location

PDU Name (from "Name" column if PDU type, or deduced from RPP association)


Ensure the output is a clean Excel with the added "Old RPP Name" column appended to the end.




---

ðŸ’¡ Bonus:

If your Copilot supports Python pandas, hereâ€™s a sample logic it can base the script on:

import pandas as pd

# Load both sheets
original = pd.read_csv("floor_pdu_alt.csv")
modified = pd.read_csv("floor_pdu_with_missing.csv")

# Merge on Site and RPP-related identifiers (assuming 'Name' column holds RPPs)
merged = modified.merge(
    original[['Site', 'Name']],
    on='Site',
    how='left',
    suffixes=('', '_Original')
)

# Add a new column to show the old name if different
merged['Old RPP Name'] = merged.apply(
    lambda row: row['Name_Original'] if row['Name'] != row['Name_Original'] else '',
    axis=1
)

# Save the result
merged.to_excel("floor_pdu_with_old_rpp_names.xlsx", index=False)

Let me know if you want this Python code as an executable script or if you'd like me to generate the Excel file directly based on what you've shown.

